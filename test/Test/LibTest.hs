{-# LANGUAGE ImplicitParams #-}

module Test.LibTest where
import Test.Tasty.HUnit (Assertion, (@?=), assertBool)
import Lib
import Graphics.Image (Pixel(PixelRGBA))
import Graphics.Image.ColorSpace (RGBA)
import Data.Word (Word8)
import Data.List.Split
unit_averagePixel = do
    let l1 = [PixelRGBA 199 219 200 157, PixelRGBA 24 174 237 199, PixelRGBA 39 210 89 238, PixelRGBA 217 237 166 124, PixelRGBA 233 99 195 62, PixelRGBA 75 216 210 179, PixelRGBA 94 18 69 24, PixelRGBA 209 32 209 226, PixelRGBA 100 65 210 78, PixelRGBA 60 249 243 73, PixelRGBA 8 35 71 76, PixelRGBA 130 206 56 249, PixelRGBA 54 18 231 237, PixelRGBA 254 133 75 155, PixelRGBA 110 76 9 94, PixelRGBA 191 84 128 79, PixelRGBA 82 42 137 118, PixelRGBA 89 99 200 128, PixelRGBA 140 64 226 38, PixelRGBA 50 39 163 34, PixelRGBA 208 181 107 197, PixelRGBA 4 125 96 181, PixelRGBA 179 184 43 149, PixelRGBA 93 105 126 177, PixelRGBA 118 85 120 217, PixelRGBA 216 99 10 166, PixelRGBA 240 85 72 71, PixelRGBA 28 178 26 192, PixelRGBA 235 101 141 18, PixelRGBA 12 84 250 53, PixelRGBA 32 102 209 124, PixelRGBA 5 234 140 209, PixelRGBA 177 250 121 194, PixelRGBA 14 132 105 60, PixelRGBA 218 91 78 208, PixelRGBA 119 142 93 146, PixelRGBA 63 145 5 173, PixelRGBA 83 64 217 154, PixelRGBA 193 73 213 209, PixelRGBA 179 244 103 156, PixelRGBA 223 51 66 113, PixelRGBA 18 149 182 50, PixelRGBA 188 24 215 96, PixelRGBA 167 27 116 77, PixelRGBA 235 108 40 110, PixelRGBA 63 50 198 160, PixelRGBA 26 56 140 106, PixelRGBA 145 42 42 238, PixelRGBA 100 210 229 21, PixelRGBA 146 218 106 51, PixelRGBA 246 43 224 146, PixelRGBA 118 229 159 174, PixelRGBA 220 195 3 46, PixelRGBA 163 241 221 131, PixelRGBA 197 108 214 140, PixelRGBA 54 144 157 145, PixelRGBA 57 57 13 212, PixelRGBA 252 119 147 50, PixelRGBA 214 167 18 140, PixelRGBA 210 85 228 121, PixelRGBA 189 58 41 242, PixelRGBA 169 71 238 8, PixelRGBA 191 235 100 253, PixelRGBA 139 237 205 162, PixelRGBA 184 114 236 175, PixelRGBA 225 168 40 185, PixelRGBA 34 147 238 62, PixelRGBA 224 56 199 191, PixelRGBA 0 66 201 78, PixelRGBA 101 22 200 72, PixelRGBA 144 95 9 170, PixelRGBA 237 186 231 195, PixelRGBA 248 16 133 159, PixelRGBA 50 150 184 11, PixelRGBA 5 88 205 251, PixelRGBA 79 125 111 85, PixelRGBA 83 115 133 74, PixelRGBA 234 162 125 154, PixelRGBA 55 111 107 95, PixelRGBA 7 7 82 143, PixelRGBA 23 96 237 147, PixelRGBA 126 37 93 247, PixelRGBA 214 69 69 116, PixelRGBA 186 147 227 92, PixelRGBA 121 16 116 142, PixelRGBA 245 220 236 221, PixelRGBA 92 242 82 18, PixelRGBA 190 244 70 85, PixelRGBA 187 126 189 65, PixelRGBA 111 95 146 100, PixelRGBA 234 43 88 20, PixelRGBA 100 44 44 76, PixelRGBA 254 8 89 134, PixelRGBA 32 19 242 188, PixelRGBA 20 189 124 202, PixelRGBA 21 32 39 244, PixelRGBA 9 105 61 173, PixelRGBA 189 4 104 127, PixelRGBA 74 195 228 40, PixelRGBA 51 60 5 1]
    let l2 = [PixelRGBA 38 82 81 167, PixelRGBA 201 19 203 179, PixelRGBA 165 246 27 169, PixelRGBA 253 226 90 220, PixelRGBA 210 98 57 23, PixelRGBA 75 201 75 74, PixelRGBA 113 68 223 110, PixelRGBA 252 66 46 206, PixelRGBA 19 198 204 96, PixelRGBA 196 85 80 130, PixelRGBA 187 175 80 5, PixelRGBA 236 141 30 169, PixelRGBA 109 41 82 28, PixelRGBA 205 54 148 145, PixelRGBA 243 158 87 24, PixelRGBA 125 166 98 167, PixelRGBA 40 198 2 34, PixelRGBA 133 28 88 144, PixelRGBA 53 51 221 118, PixelRGBA 71 63 134 158, PixelRGBA 253 96 0 216, PixelRGBA 52 70 58 41, PixelRGBA 115 128 39 235, PixelRGBA 178 104 45 129, PixelRGBA 107 73 203 134, PixelRGBA 218 249 167 120, PixelRGBA 190 103 43 172, PixelRGBA 123 175 160 74, PixelRGBA 185 126 151 18, PixelRGBA 81 79 123 0, PixelRGBA 187 153 244 142, PixelRGBA 147 0 93 78, PixelRGBA 179 157 12 250, PixelRGBA 209 217 223 211, PixelRGBA 147 246 128 23, PixelRGBA 173 140 110 143, PixelRGBA 21 77 67 68, PixelRGBA 83 253 234 229, PixelRGBA 138 28 11 138, PixelRGBA 45 75 212 190, PixelRGBA 61 233 17 238, PixelRGBA 9 105 41 211, PixelRGBA 121 199 124 88, PixelRGBA 84 100 125 88, PixelRGBA 39 3 163 157, PixelRGBA 60 233 55 216, PixelRGBA 74 107 56 117, PixelRGBA 109 79 116 98, PixelRGBA 72 64 210 57, PixelRGBA 91 80 185 203, PixelRGBA 49 236 128 22, PixelRGBA 187 105 119 183, PixelRGBA 120 174 66 200, PixelRGBA 230 215 105 17, PixelRGBA 231 69 144 13, PixelRGBA 142 218 188 147, PixelRGBA 10 161 36 85, PixelRGBA 214 143 154 211, PixelRGBA 78 27 26 250, PixelRGBA 33 95 233 100, PixelRGBA 37 176 28 163, PixelRGBA 222 168 110 120, PixelRGBA 64 34 101 82, PixelRGBA 181 59 78 46, PixelRGBA 220 111 51 243, PixelRGBA 217 254 98 33, PixelRGBA 213 95 216 25, PixelRGBA 72 244 193 231, PixelRGBA 44 138 92 77, PixelRGBA 103 62 196 182, PixelRGBA 247 227 20 91, PixelRGBA 116 205 236 68, PixelRGBA 252 135 109 232, PixelRGBA 36 234 220 8, PixelRGBA 245 54 45 195, PixelRGBA 46 91 164 12, PixelRGBA 211 160 171 95, PixelRGBA 176 86 249 44, PixelRGBA 184 241 230 207, PixelRGBA 5 168 190 63, PixelRGBA 201 228 110 114, PixelRGBA 107 187 154 17, PixelRGBA 114 75 176 188, PixelRGBA 168 12 89 157, PixelRGBA 92 232 140 157, PixelRGBA 104 152 231 121, PixelRGBA 194 244 190 44, PixelRGBA 214 213 31 195, PixelRGBA 132 127 249 181, PixelRGBA 166 187 61 73, PixelRGBA 55 246 231 234, PixelRGBA 158 116 67 232, PixelRGBA 29 91 174 83, PixelRGBA 17 102 133 241, PixelRGBA 47 50 125 57, PixelRGBA 234 28 156 78, PixelRGBA 230 184 99 232, PixelRGBA 109 46 42 151, PixelRGBA 215 248 123 151, PixelRGBA 89 4 178 130, PixelRGBA 148 155 224 55, PixelRGBA 77 45 74 102, PixelRGBA 128 27 83 210, PixelRGBA 254 18 13 212, PixelRGBA 8 71 136 245, PixelRGBA 236 252 115 157, PixelRGBA 215 203 177 62, PixelRGBA 50 20 75 33, PixelRGBA 155 184 245 170, PixelRGBA 156 178 135 68, PixelRGBA 95 74 34 215, PixelRGBA 107 195 30 127, PixelRGBA 177 158 75 157, PixelRGBA 144 230 197 42, PixelRGBA 1 87 37 24, PixelRGBA 230 47 52 34, PixelRGBA 86 179 82 115, PixelRGBA 231 86 210 144, PixelRGBA 245 215 33 186, PixelRGBA 200 93 254 102, PixelRGBA 117 244 133 211, PixelRGBA 89 98 35 35, PixelRGBA 198 246 176 215, PixelRGBA 214 165 147 201, PixelRGBA 218 52 78 207, PixelRGBA 31 156 119 180, PixelRGBA 170 104 92 202, PixelRGBA 233 14 91 222, PixelRGBA 171 108 210 178, PixelRGBA 156 110 31 85, PixelRGBA 59 148 15 162, PixelRGBA 151 204 221 242, PixelRGBA 237 224 10 84, PixelRGBA 84 222 176 38, PixelRGBA 100 25 214 205, PixelRGBA 27 180 70 181, PixelRGBA 101 123 169 208, PixelRGBA 81 127 194 4, PixelRGBA 163 141 81 140, PixelRGBA 40 86 136 63, PixelRGBA 5 76 55 87, PixelRGBA 77 219 49 180, PixelRGBA 36 39 4 34, PixelRGBA 159 173 229 62, PixelRGBA 116 235 7 108, PixelRGBA 229 170 190 14, PixelRGBA 137 233 20 197, PixelRGBA 253 177 242 211, PixelRGBA 14 47 219 159, PixelRGBA 168 56 229 33, PixelRGBA 234 65 177 111, PixelRGBA 222 50 16 155, PixelRGBA 164 107 67 178, PixelRGBA 64 34 19 171, PixelRGBA 47 106 191 65, PixelRGBA 124 130 83 1, PixelRGBA 20 42 55 200, PixelRGBA 223 126 96 134, PixelRGBA 52 14 186 9, PixelRGBA 54 250 31 79, PixelRGBA 167 56 122 36, PixelRGBA 139 39 190 230, PixelRGBA 36 187 41 108, PixelRGBA 169 217 35 3, PixelRGBA 243 214 217 175, PixelRGBA 190 26 202 223, PixelRGBA 249 1 10 107, PixelRGBA 245 21 199 135, PixelRGBA 6 249 45 34, PixelRGBA 237 180 46 87, PixelRGBA 130 99 169 168, PixelRGBA 59 31 8 225, PixelRGBA 95 49 227 98, PixelRGBA 193 72 47 66, PixelRGBA 122 201 48 200, PixelRGBA 11 69 250 140, PixelRGBA 45 156 88 192, PixelRGBA 191 24 157 110, PixelRGBA 9 185 130 32, PixelRGBA 203 227 197 135, PixelRGBA 107 202 32 81, PixelRGBA 162 12 160 18, PixelRGBA 72 246 203 233, PixelRGBA 170 239 58 43, PixelRGBA 147 237 36 0, PixelRGBA 49 47 201 103, PixelRGBA 128 75 231 3, PixelRGBA 135 194 150 93, PixelRGBA 7 222 208 206, PixelRGBA 29 11 79 114, PixelRGBA 124 40 134 91, PixelRGBA 1 123 21 15, PixelRGBA 0 44 106 137, PixelRGBA 94 43 85 55, PixelRGBA 191 226 164 136, PixelRGBA 14 167 157 242, PixelRGBA 72 119 239 199, PixelRGBA 150 180 254 140, PixelRGBA 95 117 10 150, PixelRGBA 239 152 127 90]
    let l3 = [PixelRGBA 227 83 136 32, PixelRGBA 60 174 131 157, PixelRGBA 165 151 125 115, PixelRGBA 150 146 18 189, PixelRGBA 22 234 40 77, PixelRGBA 139 91 110 245, PixelRGBA 182 241 2 23, PixelRGBA 196 190 195 69, PixelRGBA 168 188 232 103, PixelRGBA 56 204 147 164, PixelRGBA 126 158 54 56, PixelRGBA 111 62 145 194, PixelRGBA 250 156 140 6, PixelRGBA 35 150 83 252, PixelRGBA 248 71 248 147, PixelRGBA 194 222 85 13, PixelRGBA 173 72 115 125, PixelRGBA 146 233 150 42, PixelRGBA 114 103 92 25, PixelRGBA 220 210 229 224, PixelRGBA 11 184 88 247, PixelRGBA 183 16 63 202, PixelRGBA 186 124 175 78, PixelRGBA 45 10 241 74, PixelRGBA 130 33 29 141, PixelRGBA 237 205 7 236, PixelRGBA 81 132 52 10, PixelRGBA 16 97 162 98, PixelRGBA 77 179 213 86, PixelRGBA 122 33 186 180, PixelRGBA 45 15 105 254, PixelRGBA 25 46 30 82, PixelRGBA 117 212 240 252, PixelRGBA 62 69 110 40, PixelRGBA 187 163 59 105, PixelRGBA 250 77 237 136, PixelRGBA 94 140 129 141, PixelRGBA 83 16 163 244, PixelRGBA 170 96 95 159, PixelRGBA 249 33 159 24, PixelRGBA 14 251 233 207, PixelRGBA 117 237 10 49, PixelRGBA 199 128 22 32, PixelRGBA 220 92 28 90, PixelRGBA 138 190 215 107, PixelRGBA 243 188 161 21, PixelRGBA 249 94 77 252, PixelRGBA 182 234 32 139, PixelRGBA 171 235 79 15, PixelRGBA 19 115 221 160, PixelRGBA 175 186 112 102, PixelRGBA 127 102 50 124, PixelRGBA 219 84 35 170, PixelRGBA 252 224 197 199, PixelRGBA 184 46 223 5, PixelRGBA 128 216 79 210, PixelRGBA 170 156 186 119, PixelRGBA 235 62 187 16, PixelRGBA 177 127 45 48, PixelRGBA 54 11 82 7, PixelRGBA 98 60 39 58, PixelRGBA 158 68 151 206, PixelRGBA 107 143 131 1, PixelRGBA 144 203 245 58, PixelRGBA 174 124 161 47, PixelRGBA 193 14 207 10, PixelRGBA 76 26 27 176, PixelRGBA 59 174 17 17, PixelRGBA 52 176 102 6, PixelRGBA 71 156 183 105, PixelRGBA 58 10 126 252, PixelRGBA 225 108 136 52, PixelRGBA 74 209 96 18, PixelRGBA 55 227 195 94, PixelRGBA 66 174 125 2, PixelRGBA 184 130 117 158, PixelRGBA 249 135 157 174, PixelRGBA 223 21 24 103, PixelRGBA 105 158 67 173, PixelRGBA 123 193 135 252, PixelRGBA 81 128 55 74, PixelRGBA 98 200 173 220, PixelRGBA 162 221 170 26, PixelRGBA 232 99 235 133, PixelRGBA 39 145 161 124, PixelRGBA 26 121 84 192, PixelRGBA 157 219 217 70, PixelRGBA 128 155 79 217, PixelRGBA 98 158 178 166, PixelRGBA 102 77 212 158, PixelRGBA 241 100 99 246, PixelRGBA 67 125 24 214, PixelRGBA 188 141 102 199, PixelRGBA 198 215 199 114, PixelRGBA 185 247 83 40, PixelRGBA 91 112 20 134, PixelRGBA 221 127 223 241, PixelRGBA 3 252 74 41, PixelRGBA 231 92 246 57, PixelRGBA 236 151 97 225, PixelRGBA 149 213 149 99, PixelRGBA 165 164 208 74, PixelRGBA 216 172 124 118, PixelRGBA 171 202 65 204, PixelRGBA 103 183 62 93, PixelRGBA 3 225 93 187, PixelRGBA 68 124 162 214, PixelRGBA 157 150 65 248, PixelRGBA 35 14 49 46, PixelRGBA 1 243 11 15, PixelRGBA 24 23 24 73, PixelRGBA 87 57 144 218, PixelRGBA 55 152 90 197, PixelRGBA 241 103 90 103, PixelRGBA 99 217 215 17, PixelRGBA 208 33 20 44, PixelRGBA 180 23 128 212, PixelRGBA 190 123 211 3, PixelRGBA 183 88 33 133, PixelRGBA 26 50 26 49, PixelRGBA 60 204 249 207, PixelRGBA 183 152 174 176, PixelRGBA 41 228 84 30, PixelRGBA 179 205 182 69, PixelRGBA 249 58 76 145, PixelRGBA 71 130 107 219, PixelRGBA 136 177 169 174, PixelRGBA 197 14 10 200, PixelRGBA 153 21 57 31, PixelRGBA 140 87 245 120, PixelRGBA 118 207 28 219, PixelRGBA 120 20 80 189, PixelRGBA 94 63 2 82, PixelRGBA 45 114 36 68, PixelRGBA 204 236 27 197, PixelRGBA 184 59 70 41, PixelRGBA 34 242 168 227, PixelRGBA 83 119 79 226, PixelRGBA 253 250 210 122, PixelRGBA 122 114 253 114, PixelRGBA 41 147 156 36, PixelRGBA 233 65 254 113, PixelRGBA 22 211 125 217, PixelRGBA 75 82 71 249, PixelRGBA 110 204 233 79, PixelRGBA 9 179 113 79, PixelRGBA 20 72 69 94, PixelRGBA 151 147 201 230, PixelRGBA 61 49 63 37, PixelRGBA 14 193 252 201, PixelRGBA 91 211 132 59, PixelRGBA 211 32 139 80, PixelRGBA 217 67 154 68, PixelRGBA 150 59 151 53, PixelRGBA 208 91 189 253, PixelRGBA 146 130 252 84, PixelRGBA 134 219 234 5, PixelRGBA 219 245 222 129, PixelRGBA 155 237 105 168, PixelRGBA 127 205 51 145, PixelRGBA 115 107 227 105, PixelRGBA 104 220 179 45, PixelRGBA 42 234 200 184, PixelRGBA 232 173 44 143, PixelRGBA 219 202 76 208, PixelRGBA 65 30 89 40, PixelRGBA 183 72 6 86, PixelRGBA 64 80 173 120, PixelRGBA 1 173 5 52, PixelRGBA 14 110 65 246, PixelRGBA 157 119 2 254, PixelRGBA 162 84 118 137, PixelRGBA 65 40 189 128, PixelRGBA 91 13 252 192, PixelRGBA 75 1 42 74, PixelRGBA 103 167 218 190, PixelRGBA 120 108 221 71, PixelRGBA 120 125 105 147, PixelRGBA 18 174 122 96, PixelRGBA 39 251 18 242, PixelRGBA 57 156 73 254, PixelRGBA 1 141 120 245, PixelRGBA 110 109 244 49, PixelRGBA 140 27 97 1, PixelRGBA 60 138 139 53, PixelRGBA 149 136 194 86, PixelRGBA 238 27 131 225, PixelRGBA 130 226 5 56, PixelRGBA 160 82 76 105, PixelRGBA 57 91 126 30, PixelRGBA 47 163 216 62, PixelRGBA 211 125 226 30, PixelRGBA 25 25 18 205, PixelRGBA 105 182 61 253, PixelRGBA 192 26 134 179, PixelRGBA 77 241 26 194, PixelRGBA 148 110 182 188, PixelRGBA 162 98 82 109, PixelRGBA 56 65 102 232, PixelRGBA 229 131 89 20, PixelRGBA 83 114 173 7, PixelRGBA 36 200 105 186, PixelRGBA 196 77 144 246, PixelRGBA 78 221 36 210, PixelRGBA 19 177 70 135, PixelRGBA 28 152 247 239, PixelRGBA 253 27 101 70, PixelRGBA 97 86 57 165, PixelRGBA 114 76 34 117, PixelRGBA 227 233 203 224, PixelRGBA 27 149 116 168, PixelRGBA 143 14 57 139, PixelRGBA 203 202 249 170, PixelRGBA 20 5 16 197, PixelRGBA 240 143 128 195, PixelRGBA 140 229 221 156, PixelRGBA 149 199 170 57, PixelRGBA 41 210 199 234, PixelRGBA 3 185 142 213, PixelRGBA 77 236 73 45, PixelRGBA 27 89 142 165, PixelRGBA 182 53 231 20, PixelRGBA 99 248 236 24, PixelRGBA 100 136 224 53, PixelRGBA 101 29 70 189, PixelRGBA 158 236 72 202, PixelRGBA 63 240 147 129, PixelRGBA 190 249 70 221, PixelRGBA 43 242 169 129, PixelRGBA 89 108 47 53, PixelRGBA 237 8 237 73, PixelRGBA 57 147 137 234, PixelRGBA 16 30 8 73, PixelRGBA 88 130 213 141, PixelRGBA 180 239 200 28, PixelRGBA 246 126 63 177, PixelRGBA 235 79 40 147, PixelRGBA 238 226 99 210, PixelRGBA 128 164 203 56, PixelRGBA 76 222 88 20, PixelRGBA 247 186 187 57, PixelRGBA 216 106 166 161, PixelRGBA 13 47 150 231, PixelRGBA 135 91 59 120, PixelRGBA 226 28 85 44, PixelRGBA 200 22 243 50, PixelRGBA 204 27 29 97, PixelRGBA 198 86 157 118, PixelRGBA 97 98 3 194, PixelRGBA 237 239 251 167, PixelRGBA 77 127 242 243, PixelRGBA 49 91 18 101, PixelRGBA 153 183 196 67, PixelRGBA 65 24 176 163, PixelRGBA 234 110 222 167, PixelRGBA 20 119 42 22, PixelRGBA 147 85 101 21, PixelRGBA 121 210 1 254, PixelRGBA 60 122 84 112, PixelRGBA 100 197 133 23, PixelRGBA 217 20 171 176, PixelRGBA 94 71 3 47, PixelRGBA 182 240 181 31, PixelRGBA 123 117 240 107, PixelRGBA 116 193 223 10, PixelRGBA 145 62 182 54, PixelRGBA 170 63 226 120, PixelRGBA 186 13 119 178, PixelRGBA 46 230 71 110, PixelRGBA 163 208 18 12, PixelRGBA 43 103 99 114, PixelRGBA 205 243 203 253, PixelRGBA 234 6 218 15, PixelRGBA 174 215 110 171, PixelRGBA 126 133 115 38, PixelRGBA 72 222 228 73, PixelRGBA 113 223 65 31, PixelRGBA 195 16 92 34, PixelRGBA 10 161 93 112, PixelRGBA 155 97 87 17, PixelRGBA 252 173 221 215, PixelRGBA 58 225 18 34, PixelRGBA 48 31 150 0, PixelRGBA 85 241 150 127, PixelRGBA 149 254 207 118, PixelRGBA 226 161 238 18, PixelRGBA 206 10 108 191, PixelRGBA 100 210 186 152, PixelRGBA 231 6 242 211, PixelRGBA 176 74 107 57, PixelRGBA 89 182 92 249, PixelRGBA 116 1 185 160, PixelRGBA 206 121 169 176, PixelRGBA 236 30 107 168, PixelRGBA 32 167 225 107, PixelRGBA 71 60 197 75, PixelRGBA 101 234 5 13, PixelRGBA 69 129 198 124, PixelRGBA 232 105 178 67, PixelRGBA 63 86 55 208]
    let l4 = [PixelRGBA 255 255 255 255]
    pixListAveragePixel l1 @?= PixelRGBA 128 115 136 131
    pixListAveragePixel l2 @?= PixelRGBA 130 129 120 125
    pixListAveragePixel l3 @?= PixelRGBA 129 132 127 123
    pixListAveragePixel l4 @?= PixelRGBA 255 255 255 255
unit_pixelizeRow = do
    let l1 = [PixelRGBA 98 224 247 196, PixelRGBA 17 19 150 66, PixelRGBA 100 103 127 71, PixelRGBA 115 157 155 112, PixelRGBA 152 18 170 99, PixelRGBA 6 130 67 114, PixelRGBA 35 200 209 116, PixelRGBA 128 221 120 0, PixelRGBA 149 138 153 72, PixelRGBA 59 170 111 130, PixelRGBA 50 183 96 115, PixelRGBA 170 236 148 140]::[Pixel RGBA Word8]
    let res1 = [PixelRGBA 71 115 174 111, PixelRGBA 71 115 174 111, PixelRGBA 71 115 174 111, PixelRGBA 91 101 130 108, PixelRGBA 91 101 130 108, PixelRGBA 91 101 130 108, PixelRGBA 104 186 160 62, PixelRGBA 104 186 160 62, PixelRGBA 104 186 160 62, PixelRGBA 93 196 118 128, PixelRGBA 93 196 118 128, PixelRGBA 93 196 118 128]::[Pixel RGBA Word8]
    let k = 3 :: Int
    concatMap (`pixelizeN` k) (chunksOf k l1) @?= res1

    let l2 = [PixelRGBA 193 148 30 18, PixelRGBA 227 74 48 145, PixelRGBA 77 38 236 106, PixelRGBA 44 189 145 108, PixelRGBA 233 158 68 248, PixelRGBA 119 212 37 239, PixelRGBA 54 226 214 116, PixelRGBA 26 95 187 182, PixelRGBA 211 67 214 153, PixelRGBA 218 242 48 13]
    let res2 = [PixelRGBA 165 86 104 89, PixelRGBA 165 86 104 89, PixelRGBA 165 86 104 89, PixelRGBA 132 186 83 198, PixelRGBA 132 186 83 198, PixelRGBA 132 186 83 198, PixelRGBA 97 129 205 150, PixelRGBA 97 129 205 150, PixelRGBA 97 129 205 150, PixelRGBA 218 242 48 13, PixelRGBA 218 242 48 13, PixelRGBA 218 242 48 13]::[Pixel RGBA Word8]
    let k2 = 3 :: Int
    concatMap (`pixelizeN` k2) (chunksOf k2 l2) @?= res2

    let l4 = [PixelRGBA 79 179 29 175, PixelRGBA 119 23 112 29, PixelRGBA 52 144 176 61, PixelRGBA 171 88 48 191, PixelRGBA 246 238 44 112, PixelRGBA 72 27 40 24, PixelRGBA 82 46 158 110, PixelRGBA 219 135 12 86, PixelRGBA 108 252 92 65, PixelRGBA 175 253 80 150, PixelRGBA 220 18 208 193, PixelRGBA 95 187 67 188, PixelRGBA 242 161 80 184, PixelRGBA 60 226 59 117, PixelRGBA 250 235 138 152, PixelRGBA 123 147 29 71, PixelRGBA 154 81 150 1, PixelRGBA 112 47 61 186, PixelRGBA 169 125 206 209, PixelRGBA 14 69 55 156, PixelRGBA 32 142 247 185, PixelRGBA 80 215 127 61, PixelRGBA 2 83 121 89, PixelRGBA 191 26 244 191, PixelRGBA 97 176 100 192, PixelRGBA 199 11 110 94, PixelRGBA 243 250 59 2, PixelRGBA 162 36 221 2, PixelRGBA 199 150 230 163, PixelRGBA 141 12 87 30, PixelRGBA 132 20 215 118, PixelRGBA 182 215 228 90, PixelRGBA 136 158 121 53, PixelRGBA 73 1 24 23, PixelRGBA 92 115 66 202, PixelRGBA 187 227 140 79, PixelRGBA 105 145 127 228, PixelRGBA 249 201 253 206, PixelRGBA 50 121 26 156, PixelRGBA 74 63 174 73, PixelRGBA 241 149 188 202, PixelRGBA 126 40 161 130, PixelRGBA 153 53 189 137, PixelRGBA 140 204 35 136, PixelRGBA 55 161 216 61, PixelRGBA 21 110 215 4, PixelRGBA 33 214 210 107, PixelRGBA 220 229 137 20, PixelRGBA 73 114 144 55, PixelRGBA 183 42 83 201, PixelRGBA 6 179 48 218, PixelRGBA 43 252 138 113, PixelRGBA 42 4 152 163, PixelRGBA 174 112 254 52, PixelRGBA 121 238 180 239, PixelRGBA 2 112 186 66, PixelRGBA 49 190 80 252, PixelRGBA 196 169 126 55, PixelRGBA 23 6 93 25, PixelRGBA 15 101 54 128, PixelRGBA 189 202 69 69, PixelRGBA 238 11 137 115, PixelRGBA 155 38 141 245, PixelRGBA 40 187 11 117, PixelRGBA 16 147 152 31, PixelRGBA 8 156 129 117, PixelRGBA 41 253 47 157, PixelRGBA 152 58 87 76, PixelRGBA 84 142 66 141, PixelRGBA 173 43 12 82, PixelRGBA 48 69 71 126, PixelRGBA 14 89 222 177, PixelRGBA 220 242 34 69, PixelRGBA 225 213 43 214, PixelRGBA 47 252 2 245, PixelRGBA 173 192 179 87, PixelRGBA 82 52 124 60, PixelRGBA 205 33 27 77, PixelRGBA 170 212 178 143, PixelRGBA 2 24 224 79, PixelRGBA 103 206 141 59, PixelRGBA 17 223 54 159, PixelRGBA 18 142 211 56, PixelRGBA 153 102 60 40, PixelRGBA 234 201 97 108, PixelRGBA 157 234 215 177, PixelRGBA 132 1 200 252, PixelRGBA 27 74 141 77, PixelRGBA 58 197 169 211, PixelRGBA 250 162 230 251, PixelRGBA 143 45 93 43, PixelRGBA 130 145 36 96, PixelRGBA 198 32 181 162, PixelRGBA 193 0 179 121, PixelRGBA 94 25 84 187, PixelRGBA 60 35 90 181, PixelRGBA 227 59 75 36, PixelRGBA 76 59 100 59, PixelRGBA 185 149 174 188, PixelRGBA 191 248 9 98, PixelRGBA 250 89 32 50, PixelRGBA 203 20 227 23, PixelRGBA 205 208 246 29, PixelRGBA 186 44 41 99, PixelRGBA 135 2 232 6, PixelRGBA 207 201 143 28, PixelRGBA 178 40 28 245, PixelRGBA 39 219 169 91, PixelRGBA 41 42 254 76, PixelRGBA 205 3 31 111, PixelRGBA 187 147 200 244, PixelRGBA 172 60 252 18, PixelRGBA 209 110 29 157, PixelRGBA 167 162 155 245, PixelRGBA 184 129 223 135, PixelRGBA 162 85 120 16, PixelRGBA 192 48 215 24, PixelRGBA 230 61 104 39, PixelRGBA 116 120 14 211, PixelRGBA 8 201 102 53, PixelRGBA 158 44 233 40, PixelRGBA 229 248 22 108, PixelRGBA 248 123 61 156, PixelRGBA 9 248 199 91, PixelRGBA 62 241 124 14, PixelRGBA 156 119 22 73, PixelRGBA 93 150 153 10, PixelRGBA 241 168 111 92, PixelRGBA 125 249 36 91, PixelRGBA 105 113 89 14, PixelRGBA 235 86 42 146, PixelRGBA 244 174 27 28, PixelRGBA 207 112 86 20, PixelRGBA 229 138 170 79, PixelRGBA 92 105 44 36, PixelRGBA 3 151 79 206, PixelRGBA 74 56 84 13, PixelRGBA 200 115 146 3, PixelRGBA 112 84 111 247, PixelRGBA 9 127 60 139, PixelRGBA 59 232 3 224, PixelRGBA 64 154 82 185, PixelRGBA 36 128 87 251, PixelRGBA 215 35 252 42, PixelRGBA 236 113 50 235, PixelRGBA 68 30 158 195, PixelRGBA 208 235 170 7, PixelRGBA 188 234 234 205, PixelRGBA 191 60 107 112, PixelRGBA 74 109 218 42, PixelRGBA 102 21 186 63, PixelRGBA 56 97 3 53, PixelRGBA 195 221 151 214, PixelRGBA 52 23 66 44, PixelRGBA 138 144 52 119, PixelRGBA 252 77 43 242, PixelRGBA 64 98 135 144, PixelRGBA 238 117 96 201, PixelRGBA 157 52 10 180, PixelRGBA 192 208 178 5, PixelRGBA 66 4 223 186, PixelRGBA 143 111 236 108, PixelRGBA 59 115 24 240, PixelRGBA 112 32 58 215, PixelRGBA 144 7 114 227, PixelRGBA 2 88 167 250, PixelRGBA 9 149 71 233, PixelRGBA 111 102 7 73, PixelRGBA 77 51 106 179, PixelRGBA 179 28 14 75, PixelRGBA 208 146 191 23, PixelRGBA 187 163 167 232, PixelRGBA 110 38 190 67, PixelRGBA 174 247 116 62, PixelRGBA 118 47 55 65, PixelRGBA 168 29 120 75, PixelRGBA 55 22 66 1, PixelRGBA 227 162 247 139, PixelRGBA 165 8 61 225, PixelRGBA 99 62 83 217, PixelRGBA 242 159 233 216, PixelRGBA 240 180 19 234, PixelRGBA 136 55 29 133, PixelRGBA 160 220 126 38, PixelRGBA 231 116 252 118, PixelRGBA 150 253 169 171, PixelRGBA 159 249 220 193, PixelRGBA 150 141 174 13, PixelRGBA 223 80 157 179, PixelRGBA 196 29 205 236, PixelRGBA 22 95 163 9, PixelRGBA 104 206 105 64, PixelRGBA 159 120 15 207, PixelRGBA 50 72 32 117, PixelRGBA 59 40 137 89, PixelRGBA 231 22 130 166, PixelRGBA 101 128 91 127, PixelRGBA 241 121 172 16, PixelRGBA 196 237 162 14, PixelRGBA 115 78 166 82, PixelRGBA 134 63 25 137, PixelRGBA 152 198 98 77, PixelRGBA 103 224 184 244, PixelRGBA 101 42 129 50, PixelRGBA 84 96 132 98, PixelRGBA 107 26 0 146, PixelRGBA 65 120 173 51, PixelRGBA 62 122 179 193, PixelRGBA 115 198 236 192, PixelRGBA 251 177 124 211, PixelRGBA 140 133 217 247, PixelRGBA 228 203 237 12, PixelRGBA 67 36 167 228, PixelRGBA 58 45 89 138, PixelRGBA 69 8 173 116, PixelRGBA 138 142 154 144, PixelRGBA 199 244 183 84, PixelRGBA 47 49 66 177, PixelRGBA 225 79 229 7, PixelRGBA 53 203 157 195, PixelRGBA 12 156 113 186, PixelRGBA 92 172 65 241, PixelRGBA 131 122 16 139, PixelRGBA 119 147 100 248, PixelRGBA 210 165 110 163, PixelRGBA 132 134 14 100, PixelRGBA 66 232 134 249, PixelRGBA 251 142 104 173, PixelRGBA 187 36 131 200, PixelRGBA 25 101 220 205, PixelRGBA 12 220 252 12, PixelRGBA 47 168 239 186, PixelRGBA 168 142 172 3, PixelRGBA 1 87 132 142, PixelRGBA 124 39 31 111, PixelRGBA 219 192 127 39, PixelRGBA 236 84 178 85, PixelRGBA 234 250 141 194, PixelRGBA 199 242 37 50, PixelRGBA 252 51 178 179, PixelRGBA 222 61 225 10, PixelRGBA 196 30 6 7, PixelRGBA 83 76 231 6, PixelRGBA 2 81 232 9, PixelRGBA 221 204 36 11, PixelRGBA 4 226 252 1, PixelRGBA 241 14 126 71, PixelRGBA 181 39 114 22, PixelRGBA 34 240 189 156, PixelRGBA 240 82 9 111, PixelRGBA 203 148 207 199, PixelRGBA 87 88 242 20, PixelRGBA 86 2 213 244, PixelRGBA 237 80 142 201, PixelRGBA 200 15 214 101, PixelRGBA 211 240 26 253, PixelRGBA 10 199 108 118, PixelRGBA 242 93 212 126, PixelRGBA 73 52 252 66, PixelRGBA 134 25 228 81, PixelRGBA 211 38 158 113, PixelRGBA 95 5 91 240, PixelRGBA 186 228 103 7, PixelRGBA 78 211 106 213, PixelRGBA 128 156 29 215, PixelRGBA 100 208 77 214, PixelRGBA 246 109 149 82, PixelRGBA 160 123 130 79, PixelRGBA 30 210 22 199, PixelRGBA 13 91 66 45, PixelRGBA 123 237 190 5, PixelRGBA 73 239 139 232, PixelRGBA 215 209 196 212]
    let res4 = [PixelRGBA 136 130 113 118, PixelRGBA 136 130 113 118, PixelRGBA 136 130 113 118, PixelRGBA 136 130 113 118, PixelRGBA 136 130 113 118, PixelRGBA 136 130 113 118, PixelRGBA 136 130 113 118, PixelRGBA 136 130 113 118, PixelRGBA 136 130 113 118, PixelRGBA 136 130 113 118, PixelRGBA 136 130 113 118, PixelRGBA 136 130 113 118, PixelRGBA 136 130 113 118, PixelRGBA 136 130 113 118, PixelRGBA 136 130 113 118, PixelRGBA 136 130 113 118, PixelRGBA 136 130 113 118, PixelRGBA 136 130 113 118, PixelRGBA 136 130 113 118, PixelRGBA 136 130 113 118, PixelRGBA 136 130 113 118, PixelRGBA 136 130 113 118, PixelRGBA 136 130 113 118, PixelRGBA 136 130 113 118, PixelRGBA 136 130 113 118, PixelRGBA 136 130 113 118, PixelRGBA 136 130 113 118, PixelRGBA 136 130 113 118, PixelRGBA 136 130 113 118, PixelRGBA 113 132 144 119, PixelRGBA 113 132 144 119, PixelRGBA 113 132 144 119, PixelRGBA 113 132 144 119, PixelRGBA 113 132 144 119, PixelRGBA 113 132 144 119, PixelRGBA 113 132 144 119, PixelRGBA 113 132 144 119, PixelRGBA 113 132 144 119, PixelRGBA 113 132 144 119, PixelRGBA 113 132 144 119, PixelRGBA 113 132 144 119, PixelRGBA 113 132 144 119, PixelRGBA 113 132 144 119, PixelRGBA 113 132 144 119, PixelRGBA 113 132 144 119, PixelRGBA 113 132 144 119, PixelRGBA 113 132 144 119, PixelRGBA 113 132 144 119, PixelRGBA 113 132 144 119, PixelRGBA 113 132 144 119, PixelRGBA 113 132 144 119, PixelRGBA 113 132 144 119, PixelRGBA 113 132 144 119, PixelRGBA 113 132 144 119, PixelRGBA 113 132 144 119, PixelRGBA 113 132 144 119, PixelRGBA 113 132 144 119, PixelRGBA 113 132 144 119, PixelRGBA 108 132 106 118, PixelRGBA 108 132 106 118, PixelRGBA 108 132 106 118, PixelRGBA 108 132 106 118, PixelRGBA 108 132 106 118, PixelRGBA 108 132 106 118, PixelRGBA 108 132 106 118, PixelRGBA 108 132 106 118, PixelRGBA 108 132 106 118, PixelRGBA 108 132 106 118, PixelRGBA 108 132 106 118, PixelRGBA 108 132 106 118, PixelRGBA 108 132 106 118, PixelRGBA 108 132 106 118, PixelRGBA 108 132 106 118, PixelRGBA 108 132 106 118, PixelRGBA 108 132 106 118, PixelRGBA 108 132 106 118, PixelRGBA 108 132 106 118, PixelRGBA 108 132 106 118, PixelRGBA 108 132 106 118, PixelRGBA 108 132 106 118, PixelRGBA 108 132 106 118, PixelRGBA 108 132 106 118, PixelRGBA 108 132 106 118, PixelRGBA 108 132 106 118, PixelRGBA 108 132 106 118, PixelRGBA 108 132 106 118, PixelRGBA 108 132 106 118, PixelRGBA 157 96 135 113, PixelRGBA 157 96 135 113, PixelRGBA 157 96 135 113, PixelRGBA 157 96 135 113, PixelRGBA 157 96 135 113, PixelRGBA 157 96 135 113, PixelRGBA 157 96 135 113, PixelRGBA 157 96 135 113, PixelRGBA 157 96 135 113, PixelRGBA 157 96 135 113, PixelRGBA 157 96 135 113, PixelRGBA 157 96 135 113, PixelRGBA 157 96 135 113, PixelRGBA 157 96 135 113, PixelRGBA 157 96 135 113, PixelRGBA 157 96 135 113, PixelRGBA 157 96 135 113, PixelRGBA 157 96 135 113, PixelRGBA 157 96 135 113, PixelRGBA 157 96 135 113, PixelRGBA 157 96 135 113, PixelRGBA 157 96 135 113, PixelRGBA 157 96 135 113, PixelRGBA 157 96 135 113, PixelRGBA 157 96 135 113, PixelRGBA 157 96 135 113, PixelRGBA 157 96 135 113, PixelRGBA 157 96 135 113, PixelRGBA 157 96 135 113, PixelRGBA 137 135 96 98, PixelRGBA 137 135 96 98, PixelRGBA 137 135 96 98, PixelRGBA 137 135 96 98, PixelRGBA 137 135 96 98, PixelRGBA 137 135 96 98, PixelRGBA 137 135 96 98, PixelRGBA 137 135 96 98, PixelRGBA 137 135 96 98, PixelRGBA 137 135 96 98, PixelRGBA 137 135 96 98, PixelRGBA 137 135 96 98, PixelRGBA 137 135 96 98, PixelRGBA 137 135 96 98, PixelRGBA 137 135 96 98, PixelRGBA 137 135 96 98, PixelRGBA 137 135 96 98, PixelRGBA 137 135 96 98, PixelRGBA 137 135 96 98, PixelRGBA 137 135 96 98, PixelRGBA 137 135 96 98, PixelRGBA 137 135 96 98, PixelRGBA 137 135 96 98, PixelRGBA 137 135 96 98, PixelRGBA 137 135 96 98, PixelRGBA 137 135 96 98, PixelRGBA 137 135 96 98, PixelRGBA 137 135 96 98, PixelRGBA 137 135 96 98, PixelRGBA 129 103 120 137, PixelRGBA 129 103 120 137, PixelRGBA 129 103 120 137, PixelRGBA 129 103 120 137, PixelRGBA 129 103 120 137, PixelRGBA 129 103 120 137, PixelRGBA 129 103 120 137, PixelRGBA 129 103 120 137, PixelRGBA 129 103 120 137, PixelRGBA 129 103 120 137, PixelRGBA 129 103 120 137, PixelRGBA 129 103 120 137, PixelRGBA 129 103 120 137, PixelRGBA 129 103 120 137, PixelRGBA 129 103 120 137, PixelRGBA 129 103 120 137, PixelRGBA 129 103 120 137, PixelRGBA 129 103 120 137, PixelRGBA 129 103 120 137, PixelRGBA 129 103 120 137, PixelRGBA 129 103 120 137, PixelRGBA 129 103 120 137, PixelRGBA 129 103 120 137, PixelRGBA 129 103 120 137, PixelRGBA 129 103 120 137, PixelRGBA 129 103 120 137, PixelRGBA 129 103 120 137, PixelRGBA 129 103 120 137, PixelRGBA 129 103 120 137, PixelRGBA 151 117 127 124, PixelRGBA 151 117 127 124, PixelRGBA 151 117 127 124, PixelRGBA 151 117 127 124, PixelRGBA 151 117 127 124, PixelRGBA 151 117 127 124, PixelRGBA 151 117 127 124, PixelRGBA 151 117 127 124, PixelRGBA 151 117 127 124, PixelRGBA 151 117 127 124, PixelRGBA 151 117 127 124, PixelRGBA 151 117 127 124, PixelRGBA 151 117 127 124, PixelRGBA 151 117 127 124, PixelRGBA 151 117 127 124, PixelRGBA 151 117 127 124, PixelRGBA 151 117 127 124, PixelRGBA 151 117 127 124, PixelRGBA 151 117 127 124, PixelRGBA 151 117 127 124, PixelRGBA 151 117 127 124, PixelRGBA 151 117 127 124, PixelRGBA 151 117 127 124, PixelRGBA 151 117 127 124, PixelRGBA 151 117 127 124, PixelRGBA 151 117 127 124, PixelRGBA 151 117 127 124, PixelRGBA 151 117 127 124, PixelRGBA 151 117 127 124, PixelRGBA 113 128 142 151, PixelRGBA 113 128 142 151, PixelRGBA 113 128 142 151, PixelRGBA 113 128 142 151, PixelRGBA 113 128 142 151, PixelRGBA 113 128 142 151, PixelRGBA 113 128 142 151, PixelRGBA 113 128 142 151, PixelRGBA 113 128 142 151, PixelRGBA 113 128 142 151, PixelRGBA 113 128 142 151, PixelRGBA 113 128 142 151, PixelRGBA 113 128 142 151, PixelRGBA 113 128 142 151, PixelRGBA 113 128 142 151, PixelRGBA 113 128 142 151, PixelRGBA 113 128 142 151, PixelRGBA 113 128 142 151, PixelRGBA 113 128 142 151, PixelRGBA 113 128 142 151, PixelRGBA 113 128 142 151, PixelRGBA 113 128 142 151, PixelRGBA 113 128 142 151, PixelRGBA 113 128 142 151, PixelRGBA 113 128 142 151, PixelRGBA 113 128 142 151, PixelRGBA 113 128 142 151, PixelRGBA 113 128 142 151, PixelRGBA 113 128 142 151, PixelRGBA 156 107 152 94, PixelRGBA 156 107 152 94, PixelRGBA 156 107 152 94, PixelRGBA 156 107 152 94, PixelRGBA 156 107 152 94, PixelRGBA 156 107 152 94, PixelRGBA 156 107 152 94, PixelRGBA 156 107 152 94, PixelRGBA 156 107 152 94, PixelRGBA 156 107 152 94, PixelRGBA 156 107 152 94, PixelRGBA 156 107 152 94, PixelRGBA 156 107 152 94, PixelRGBA 156 107 152 94, PixelRGBA 156 107 152 94, PixelRGBA 156 107 152 94, PixelRGBA 156 107 152 94, PixelRGBA 156 107 152 94, PixelRGBA 156 107 152 94, PixelRGBA 156 107 152 94, PixelRGBA 156 107 152 94, PixelRGBA 156 107 152 94, PixelRGBA 156 107 152 94, PixelRGBA 156 107 152 94, PixelRGBA 156 107 152 94, PixelRGBA 156 107 152 94, PixelRGBA 156 107 152 94, PixelRGBA 156 107 152 94, PixelRGBA 156 107 152 94, PixelRGBA 120 168 108 145, PixelRGBA 120 168 108 145, PixelRGBA 120 168 108 145, PixelRGBA 120 168 108 145, PixelRGBA 120 168 108 145, PixelRGBA 120 168 108 145, PixelRGBA 120 168 108 145, PixelRGBA 120 168 108 145, PixelRGBA 120 168 108 145, PixelRGBA 120 168 108 145, PixelRGBA 120 168 108 145, PixelRGBA 120 168 108 145, PixelRGBA 120 168 108 145, PixelRGBA 120 168 108 145, PixelRGBA 120 168 108 145, PixelRGBA 120 168 108 145, PixelRGBA 120 168 108 145, PixelRGBA 120 168 108 145, PixelRGBA 120 168 108 145, PixelRGBA 120 168 108 145, PixelRGBA 120 168 108 145, PixelRGBA 120 168 108 145, PixelRGBA 120 168 108 145, PixelRGBA 120 168 108 145, PixelRGBA 120 168 108 145, PixelRGBA 120 168 108 145, PixelRGBA 120 168 108 145, PixelRGBA 120 168 108 145, PixelRGBA 120 168 108 145]::[Pixel RGBA Word8]
    let k4 = 29 :: Int
    concatMap (`pixelizeN` k4) (chunksOf k4 l4) @?= res4

    let l5 = [PixelRGBA 138 130 137 129]
    let res5 = replicate 1000 (PixelRGBA 138 130 137 129)
    let k5 = 1000 :: Int
    concatMap (`pixelizeN` k5) (chunksOf k5 l5) @?= res5